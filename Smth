1. Вывести все данные за 2023 год.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE EXTRACT(YEAR FROM activation_date) = 2023;


2. Вывести сумму начислений и регион за последние полгода.

SELECT reg_week2, SUM(fclc_trans_part) AS total_accruals
FROM analyze_bi.multifactor_model_mob
WHERE activation_date >= NOW() - INTERVAL '6 months'
GROUP BY reg_week2;


3. Найти все уникальные номера контрактов в регионе "Москва".

SELECT DISTINCT con_n
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Москва';


4. Посчитать количество клиентов в сегменте "ГОС".

SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE segment = 'ГОС';


5. Выбрать все тарифные планы и их описания для региона "Санкт-Петербург".

SELECT tariff_plan, tariff_plan_txt
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Санкт-Петербург';


6. Вывести все записи с контрактами, где номер телефона начинается с "900".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE phone_num::text LIKE '900%';


7. Посчитать количество активированных услуг за последний месяц.

SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE activation_date >= NOW() - INTERVAL '1 month';


8. Найти все записи для тарифного плана "Бизнес" в регионе "Новосибирск".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE tariff_plan = 'Бизнес' AND reg_week2 = 'Новосибирск';


9. Вывести уникальные идентификаторы услуг для региона "Казань".

SELECT DISTINCT service_id
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Казань';


10. Посчитать общую сумму скидок за все записи с тарифным планом "Эконом".

SELECT SUM(bsi_discount_trans)
FROM analyze_bi.multifactor_model_mob
WHERE tariff_plan = 'Эконом';


11. Выбрать все записи для клиентов из сегмента "Национальные".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE segment = 'Национальные';


12. Вывести информацию о контрактах, которые активированы в 2022 году.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE EXTRACT(YEAR FROM activation_date) = 2022;


13. Найти количество записей для каждого региона.

SELECT reg_week2, COUNT(*)
FROM analyze_bi.multifactor_model_mob
GROUP BY reg_week2;


14. Посчитать сумму начислений для всех клиентов с номером контракта "12345".

SELECT SUM(fclc_trans_part)
FROM analyze_bi.multifactor_model_mob
WHERE con_n = '12345';


15. Вывести все данные по всем продуктам "Мобильный".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE product = 'МОБИЛЬНЫЙ';


16. Найти все записи, где сумма начисления больше 5000.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE fclc_trans_part > 5000;


17. Посчитать количество активированных услуг за последние три месяца.

SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE activation_date >= NOW() - INTERVAL '3 months';


18. Выбрать все записи для клиентов из региона "Челябинск".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Челябинск';


19. Вывести среднюю сумму начислений по всем регионам.

SELECT AVG(fclc_trans_part) AS average_accruals
FROM analyze_bi.multifactor_model_mob;


20. Найти контракты с номером телефона, содержащим "8".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE phone_num::text LIKE '%8%';


21. Посчитать количество клиентов, активированных в "Самаре".

SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Самара';


22. Выбрать все уникальные маркетинговые категории.

SELECT DISTINCT m_categ
FROM analyze_bi.multifactor_model_mob;


23. Вывести записи с контрактами, активированными в феврале 2023 года.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE activation_date >= '2023-02-01' AND activation_date < '2023-03-01';


24. Найти все записи с определённым тарифным планом и его описанием.

SELECT tariff_plan, tariff_plan_txt
FROM analyze_bi.multifactor_model_mob
WHERE tariff_plan = 'Тариф 1';


25. Посчитать общую сумму начислений для региона "Ростов-на-Дону".

SELECT SUM(fclc_trans_part) AS total_accruals
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Ростов-на-Дону';


26. Выбрать все данные для клиентов с определённым идентификатором приложения.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE app_class = 123456.789;


27. Вывести записи для сегмента "Коммерческие" с конкретным тарифным планом.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE segment = 'Коммерческие' AND tariff_plan = 'Премиум';


28. Найти все контракты, активированные с 1 января по 31 марта 2023 года.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE activation_date BETWEEN '2023-01-01' AND '2023-03-31';


29. Посчитать количество клиентов для каждого типа услуги.

SELECT service_type, COUNT(*) AS client_count
FROM analyze_bi.multifactor_model_mob
GROUP BY service_type;


30. Выбрать все данные для региона "Екатеринбург" с активными услугами.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Екатеринбург' AND activation_date IS NOT NULL;


31. Вывести уникальные номера лицевых счетов.

SELECT DISTINCT acc_n
FROM analyze_bi.multifactor_model_mob;


32. Найти все записи, где скидка больше 1000.

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE bsi_discount_trans > 1000;


33. Посчитать среднюю сумму начислений по сегменту "Частные".

SELECT AVG(fclc_trans_part) AS average_accruals
FROM analyze_bi.multifactor_model_mob
WHERE segment = 'Частные';


34. Выбрать все записи по услугам с идентификатором "7890".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE service_id = 7890;


35. Вывести все записи, где идентификатор приложения равен "456".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE app_class = 456;


36. Найти контракты с номером, содержащим "123".

SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE con_n LIKE '%123%';


37. Посчитать количество записей в регионе "Уфа".

SELECT COUNT(*)
FROM analyze_bi.mult



Вот оставшиеся 40 запросов в аналогичном формате:

38. Выбрать все записи для клиентов из региона "Волгоград".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Волгоград';

39. Вывести все контракты, где тарифный план "Семейный".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE tariff_plan = 'Семейный';

40. Найти количество клиентов с номером телефона, заканчивающимся на "99".



SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE phone_num::text LIKE '%99';

41. Посчитать общую сумму начислений для услуг типа "Мобильный интернет".



SELECT SUM(fclc_trans_part) AS total_accruals
FROM analyze_bi.multifactor_model_mob
WHERE service_type_txt = 'Мобильный интернет';

42. Выбрать все данные для клиентов, у которых есть скидки.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE bsi_discount_trans > 0;

43. Вывести уникальные названия контрактов для региона "Нижний Новгород".



SELECT DISTINCT kontr_name
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Нижний Новгород';

44. Найти все записи для тарифного плана "Тариф 2" с активацией в 2023 году.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE tariff_plan = 'Тариф 2' AND EXTRACT(YEAR FROM activation_date) = 2023;

45. Посчитать количество активных клиентов в сегменте "Малый бизнес".



SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE segment = 'Малый бизнес' AND activation_date IS NOT NULL;

46. Выбрать записи для клиентов из "Астрахани" с конкретным идентификатором услуги.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Астрахань' AND service_id = 12345;

47. Вывести записи с активированными услугами в 2023 году.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE activation_date >= '2023-01-01';

48. Найти все контракты с типом услуги "Фиксированный интернет".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE service_type_txt = 'Фиксированный интернет';

49. Посчитать общую сумму скидок для региона "Тула".



SELECT SUM(bsi_discount_trans) AS total_discount
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Тула';

50. Выбрать записи для клиентов с определённым периодом активации.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE period_date = '2023-10-01';

51. Вывести все записи для клиентов с номером контракта "54321".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE con_n = '54321';

52. Найти количество услуг, активированных в регионе "Хабаровск".



SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Хабаровск';

53. Посчитать среднюю сумму начислений за услуги в сегменте "Крупный бизнес".



SELECT AVG(fclc_trans_part) AS average_accruals
FROM analyze_bi.multifactor_model_mob
WHERE segment = 'Крупный бизнес';

54. Выбрать все данные по услугам с типом "Мобильная связь".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE service_type = 1;  -- Предположим, что 1 соответствует "Мобильной связи".

55. Вывести все записи с активированными контрактами в "Сочи".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Сочи';

56. Найти уникальные номера лицевых счетов для "Калининград".



SELECT DISTINCT acc_n
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Калининград';

57. Посчитать общее количество контрактов с тарифным планом "Стандарт".



SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE tariff_plan = 'Стандарт';

58. Выбрать все записи с услугами, где номер телефона начинается с "77".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE phone_num::text LIKE '77%';

59. Вывести записи по регионам, где есть активированные контракты с номером "98765".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE con_n = '98765' AND activation_date IS NOT NULL;

60. Найти контракты, активированные с 1 апреля по 30 июня 2023 года.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE activation_date BETWEEN '2023-04-01' AND '2023-06-30';

61. Посчитать общую сумму начислений для клиентов в "Курске".



SELECT SUM(fclc_trans_part) AS total_accruals
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Курс';

62. Выбрать все записи, где маркетинговая категория "Новая".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE m_categ = 'Новая';

63. Вывести все записи с контрактами, которые активированы в 2021 году.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE EXTRACT(YEAR FROM activation_date) = 2021;

64. Найти все уникальные тарифные планы для клиентов в "Рязани".



SELECT DISTINCT tariff_plan
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Рязань';

65. Посчитать количество клиентов, у которых нет активированных услуг.



SELECT COUNT(*)
FROM analyze_bi.multifactor_model_mob
WHERE activation_date IS NULL;

66. Выбрать записи с активированными услугами в "Липецке".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Липецк' AND activation_date IS NOT NULL;

67. Вывести все записи для клиентов с номером телефона "89161234567".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE phone_num = 89161234567;

68. Найти все контракты с номером, содержащим "456".



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE con_n LIKE '%456%';

69. Посчитать среднюю скидку для всех клиентов в "Калуге".



SELECT AVG(bsi_discount_trans) AS average_discount
FROM analyze_bi.multifactor_model_mob
WHERE reg_week2 = 'Калуга';

70. Выбрать все данные по всем активированным контрактам.



SELECT *
FROM analyze_bi.multifactor_model_mob
WHERE activation_date IS NOT NULL;

